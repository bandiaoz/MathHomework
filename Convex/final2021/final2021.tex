\input{../../homework.cls}

\usepackage{tikz}

\newcommand{\Title}{CVX final 2021}
\renewcommand{\due}{due: 11 weeks}
\newcommand{\dom}{\operatorname{dom}} % 定义域
\newcommand{\minimize}{\operatorname{minimize}} % 最小化
\newcommand{\subject}{\operatorname{subject\ to}}
\newcommand{\todo}{{\color{red} to do}} % to do
\newcommand{\myline}{{\line(1,0){450}}} % 分割线


\begin{document}
\begin{problem}[判断]
    集合 $\left\{x \in \mathbb{R}^n: \|x\| \le 1\right\}$ 是凸集.
    \Answer 是.
\end{problem}

\begin{problem}[判断]
    集合 $\left\{x \in \mathbb{R}^n: \|x\| > 1\right\}$ 是凸集.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    有限个凸集的并集是凸集.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    集合 $\left\{x \in \mathbb{R}^n: \|x\| < 1, a^tx \le 1\right\}$ 是凸集，其中 $a \in \mathbb{R}^n$ 是给定的非 0 向量.
    \Answer 是.
\end{problem}

\begin{problem}[判断]
    集合 $\left\{(x, y) \in \mathbb{R}^2: |e^ax + e^{-a}y| \le 1, -1 \le a \le 1\right\}$ 是凸集.
    \Answer 是.
    \begin{theorem}
        如果对于 $\forall x, y \in S$，都有 $\lambda x + (1 - \lambda)y \in S$，则集合 $S$ 是一个凸集.
    \end{theorem}
    \begin{proof}
        $\forall (x_1, y_1), (x_2, y_2) \in S, \lambda \in (0, 1)$，$(x_3, y_3) = (\lambda x_1 + (1 - \lambda)x_2, \lambda y_1 + (1 - \lambda)y_2)$
        \begin{align*}
            &|e^ax_3 + e^{-a}y_3| \\
            =& |e^a(\lambda x_1 + (1 - \lambda)x_2) + e^{-a}(\lambda y_1 + (1 - \lambda)y_2)| \\
            \le& \lambda |e^ax_1 + e^{-a}y_1| + (1 - \lambda) |e^ax_2 + e^{-a}y_2| \\
            \le& 1
        \end{align*}
        $(x_3, y_3) \in S \Longrightarrow$ 集合 $S$ 是一个凸集.
    \end{proof}
\end{problem}

\begin{problem}[判断]
    凸函数一定可微.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    对于一元可微函数 $f$，$f$ 是凸函数当且仅当 $f(y) \ge f(x) + (y - x)f^\prime(x)$ 对任何 $x, y$ 成立.
    \Answer 否，还要求 $\dom(f)$ 是凸集.
\end{problem}

\begin{problem}[判断]
    二元函数 $f(x, y) = x^2 + 2y^2 + 3xy$ 是定义在 $\mathbb{R}^2$ 上的凸函数.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    若一元函数 $f(x) > 0$ 是开区间 $(a, b)$ 上的凸函数，则 $\log f(x)$ 亦是 $(a, b)$ 上的凸函数.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    定义在 $\mathbb{R}$ 上的一元单调递增函数一定是凸函数.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    凸优化问题中，强对偶永远成立.
    \Answer 否.
\end{problem}

\begin{problem}[判断]
    对于凸优化中的QP问题，KKT条件永远成立.
    \Answer 是.
\end{problem}

\begin{problem}[判断]
    线性模型的 SVM 中，最后得到的解仅依赖于支撑向量.
    \Answer 是.
\end{problem}

\begin{problem}[判断]
    通过梯度下降方法求解凸优化问题，通常可以收敛到全局极小值点.
    \Answer 是.
\end{problem}

\begin{problem}[判断]
    定义在集合 $\left\{x \in \mathbb{R}^2: \|x\| \le 1\right\}$ 上的凸函数一定存在极小值点.
    \Answer 是.
\end{problem}

\begin{problem}[判断]
    定义在集合 $\left\{x \in \mathbb{R}^2: \|x\| < 1\right\}$ 上的凸函数一定存在极小值点.
    \Answer 否.
\end{problem}

\begin{problem}[问答]
    写出 $f(x) = x\log x$ 的对偶函数.
    \begin{theorem}
        函数 $f$ 的共轭函数：$f^{*}(y) \triangleq \underset{x \in \dom(f)}{\sup}\left(y^{t} x-f(x)\right)$
    \end{theorem}
    \Answer \begin{align*}
        f^*(y) &\triangleq \underset{x \in \dom(f)}{\sup}\left(y x-f(x)\right)\\
        &= \underset{x > 0}{\sup} (yx - x\log x)\\
        &= e^{y - 1}        
    \end{align*}
\end{problem}

\begin{problem}[问答]
    若整数 $n \ge 0$ 使得 $f(x, y) = x^2 + xy^{n - 1} + y^n$ 是 $\mathbb{R}^2$ 上的凸函数，则 $n$ 的所有取值是多少？
    \Answer $n \in \left\{1, 2\right\}. $\begin{itemize}
        \item 当 $n = 0$ 时，$f(x, y) = x^2 + \frac{x}{y} + 1$，$\nabla^2 f = \frac{1}{y^3}\begin{bmatrix}
            2y^3 & -y\\
            -y & 2x
        \end{bmatrix}$ 不是半正定.
        \item 当 $n = 1$ 时，$f(x, y) = x^2 + x + y$，$\nabla^2 f = \begin{bmatrix}
            2 & 0 \\
            0 & 0
        \end{bmatrix}$ 半正定.
        \item 当 $n = 2$ 时，$f(x, y) = x^2 + xy + y^2$，$\nabla^2f = \begin{bmatrix}
            2 & 1\\
            1 & 2
        \end{bmatrix}$ 正定.
        \item 当 $n \ge 3$ 时，$f(x, y) = x^2 + xy^{n - 1} + y^n$，\[\nabla^2f = \begin{bmatrix}
            2 & (n - 1)y^{n - 2}\\
            (n - 1)y^{n - 2} & (n - 1)(n - 2)xy^{n - 3} + n(n - 1)y^{n - 2}
        \end{bmatrix}\] 不是半正定.
    \end{itemize}
\end{problem}

\begin{problem}[问答]
    给出优化问题 $\begin{cases}
        \minimize \quad & a^tx\\
        \subject \quad & x \succeq 0
    \end{cases}$ 的解，其中 $a\in \mathbb{R}^n$.
    \Answer 如果 $a \succeq 0$，则 $x^* = 0, p^* = 0$，否则 $a_i < 0$，当 $j \neq i$，$x_j = 0$，$x_i = \lambda a_i$，$\lambda \to -\infty$，$p^* = -\infty$.
\end{problem}

\begin{problem}[问答]
    叙述强凸函数 (strongly convex) 的定义.
    \Answer $f:\mathbb{R}^n \to \mathbb{R}$，$\dom(f)$ 是凸集，$\exists m > 0$, s.t. $g(x) = f(x) - \frac{m}{2}\|x\|^2$ 是凸函数，即 $g(\lambda x + (1 - \lambda)y) \le \lambda g(x) + (1 - \lambda)g(y)$.
\end{problem}

\begin{problem}[问答]
    叙述严格凸函数(strictly convex)的定义.
    \Answer $f:\mathbb{R}^n \to \mathbb{R}$，$\dom(f)$ 是凸集，并且 $f(\lambda x + (1 - \lambda)y) < \lambda f(x) + (1 - \lambda)f(y)$.
\end{problem}

\begin{problem}[问答]
    写出 $f(x) = \frac{1}{2}x^tPx + q^tx + r$ 的极小值点和极小值，其中 $P \in \mathbb{S}_{++}^n, q \in \mathbb{R}^n, r \in \mathbb{R}$.
    \Answer $\nabla f(x) = Px + q$，令 $\nabla f(x) = 0$，极小值点$x^* = -P^{-1}q$，极小值 $p^* = -\frac{1}{2}q^tP^{-1}q + r$.
\end{problem}

\begin{problem}[问答]
    写出优化问题 $\begin{cases}
        \minimize \quad &f(x)\\
        \subject \quad &Ax = b
    \end{cases}$ 的拉格朗日乘子函数,其中 $A \in \mathbb{R}^{m \times n}, b \in \mathbb{R}^m$.
    \Answer $L(x, \mu) = f(x) + \mu^t(Ax - b)$，其中 $\mu \in \mathbb{R}^m$.
\end{problem}

\begin{problem}[问答]
    写出优化问题 $\begin{cases}
        \minimize \quad &f(x)\\
        \subject \quad &x \preceq a
    \end{cases}$ 的拉格朗日乘子函数,其中 $a \in \mathbb{R}^n$.
    \Answer $L(x, \lambda) = f(x) + \lambda^t(x - a)$，其中 $\lambda \in \mathbb{R}^n$.
\end{problem}

\begin{problem}[问答]
    写出优化问题 $\begin{cases}
        \minimize \quad &\|x\| \\
        \subject \quad &Ax = b
    \end{cases}$ 的拉格朗日乘子函数,其中 $A \in \mathbb{R}^{m \times n}, b \in \mathbb{R}^m$.
    \Answer $L(x, \mu) = \|x\| + \mu^t(Ax - b)$，其中 $\mu \in \mathbb{R}^m$.
\end{problem}

\begin{problem}[问答]
    给定点集 $A\subset \mathbb{R}^n$ 以及 $B \subset \mathbb{R}^m$，定义其乘积为 $A \times B = \left\{(a, b): a \in A, b \in B\right\}$.证明：若 $A$ 和 $B$ 皆为凸集，则 $A \times B$ 亦是凸集.
    \begin{proof}
        $z = \lambda z_1 + (1 - \lambda)z_2 = (\lambda a_1 + (1 - \lambda)a_2, \lambda b_1 + (1 - \lambda)b_2)$，其中 $z_1, z_2 \in A \times B, z_1 = (a_1, b_1), z_2 = (a_2, b_2), a_1, a_2 \in A, b_1, b_2 \in B$. 由于 $A$ 是一个凸集，所以 $\lambda a_1 + (1 - \lambda)a_2 \in A$，同理 $\lambda b_1 + (1 - \lambda)b_2 \in B$. 可得 $z_1 \in A, z_1 \in B \Longrightarrow z \in A\times B$. $A \times B$ 是一个凸集.
    \end{proof}
\end{problem}

\begin{problem}[问答]
    验证函数 $\|x\|^2 / y$ 是否是凸函数并给出理由，其中 $x \in \mathbb{R}^n$ 以及 $y > 0$.
    \Answer $\nabla^2f = \frac{2}{y^3}\begin{pmatrix}
        y^2I & -yx \\
        -yx^t & x^tx
    \end{pmatrix}, \begin{vmatrix}
        y^2I & -yx \\
        -yx^t & x^tx
    \end{vmatrix} = 0$，所以 $\nabla^2f \succeq 0$，$f(x, y) = \|x\|^2 / y$ 是一个凸函数. 
\end{problem}

\begin{problem}[问答]
    证明下述问题是凸优化问题并给出 KKT 条件：\[\begin{cases}
        \minimize \quad &-\sum_{i = 1}^m a_i\log(b_i^tx)\\
        \subject \quad &0 \preceq x \preceq 1, \sum_{i = 1}^nx_i = n - 1
    \end{cases}\] 其中 $x\in \mathbb{R}^n, a_i > 0$ 以及 $b_i \succ 0$.
    \Answer 目标函数 $f(x) = -\sum_{i = 1}^m a_i\log(b_i^tx)$，$\partial_{jk}f = \sum_{i = 1}^m\frac{a_ib_{ij}b_{ik}}{(b_i^tx)^2} = (b_ib_i^t)_{jk}\sum_{i = 1}^m\frac{a_i}{(b_i^tx)^2}$.所以 $\nabla^2f(x)$ 正定，目标函数是凸函数.约束条件是仿射，所以是凸优化问题.

    Lagrange 函数: $L(x, \lambda, \mu) = -\sum_{i = 1}^m a_i\log(b_i^tx) - \lambda_1^t x + \lambda_2^t(x - \mathbf{1}) + \mu(\mathbf{1}^tx - n + 1)$
    
    KKT 条件如下：\begin{itemize}
        \item $0 \preceq x \preceq 1, \sum_{i = 1}^nx_i = n - 1$
        \item $\lambda_1 \succeq 0, \lambda_2 \succeq 0$
        \item $\lambda_{1i}x_i = 0, \lambda_{2i}(x_i - 1) = 0$·
        \item $\partial_xL = 0, -\sum_{i = 1}^m\frac{a_ib_i}{b_i^tx} - \lambda_1 + \lambda_2 + \mu \mathbf{1} = 0$
    \end{itemize}
\end{problem}

\begin{problem}[问答]
    使用梯度下降方法（精确直线搜索）求出三元函数 $f(x, y, z) = x^2 + 2y^2 + 3z^2$ 的极小值点. 假设起始点为 $(1, 0, 0)$，需写出每次更新迭代的详细过程和结果.
    \Answer 
\end{problem}

\begin{problem}[问答]
    证明下述问题是凸优化问题并求解：\[\begin{cases}
        \minimize \quad &f(x, y, z) = x^2 + 2y^2 + 2z^2 + 3u^2\\
        \subject \quad &x + y + z + u = 1\\
        &x^2 + z^2 \le 1 
    \end{cases}\]
    \Answer 目标函数是二次函数，等式约束是仿射函数，不等约束是二次函数，QCQP问题是凸优化问题.

    Lagrange 函数: $L(x, y, z, \lambda, \mu) = x^2 + 2y^2 + 2z^2 + 3u^2 + \lambda(x^2 + z^2 - 1) + \mu(x + y + z + u - 1)$

    KKT 条件如下：\begin{itemize}
        \item $x + y + z + u = 1,\ x^2 + z^2 \le 1$
        \item $\lambda \ge 0$
        \item $\lambda(x^2 + z^2 - 1) = 0$
        \item $2x + 2\lambda x + \mu = 0, 4y + \mu = 0, 4z + 2\lambda z + \mu = 0$
    \end{itemize}
    根据 $\lambda(x^2 + z^2 - 1) = 0$，\begin{itemize}
        \item 当 $\lambda = 0$，$(x, y, z) = (\frac{2 - 2u}{5}, \frac{1 - u}{5}, \frac{1 - u}{5})$
        \item 当 $\lambda \neq 0 \Longrightarrow x^2 + z^2 = 1$, ... difficult, 
    \end{itemize}
\end{problem}

\end{document}